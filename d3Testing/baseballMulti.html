<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>d3 take 2</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
  <div id='container'></div>


<script>

  var data1 = [
  {year: 2000, OBP: .450, OPS: .821, SLG: .501},
  {year: 2001, OBP: .410, OPS: .801, SLG: .601},
  {year: 2002, OBP: .420, OPS: .701, SLG: .401},
  {year: 2003, OBP: .400, OPS: .961, SLG: .501},
  {year: 2004, OBP: .450, OPS: .801, SLG: .521}
]

var data2 = [
  {year: 1980, OBP: .400, OPS: .901, SLG: .601},
  {year: 1981, OBP: .460, OPS: 1.001, SLG: .701},
  {year: 1982, OBP: .320, OPS: .601, SLG: .501}
]

var data3 = [
  {year: 1990, OBP: .410, OPS: .908, SLG: .621},
  {year: 1991, OBP: .440, OPS: 1.021, SLG: .741},
  {year: 1992, OBP: .350, OPS: .961, SLG: .401},
  {year: 1993, OBP: .403, OPS: .860, SLG: .600}
]

const height = 400
const width = 1000

var svg = d3.select('#container')
  .append('svg')
  .attr('height', height)
  .attr('width', width)
  .style('border', '1px solid black')
  .style('overflow', 'visible')
  .style('margin', '20px')

  const radius = 20
  const padding = 10

  var data = [data1, data2, data3]

  function renderData(data, index, xScale, yScale){
    console.log(index, data)
    
    

    


    // axis stuff


    

  

    svg.selectAll('.d3BubbleG' + index)
      .data(data)
      .enter()
      .append('g')
      .classed('d3BubbleG' + index, true) 

    d3.selectAll('.d3BubbleG' + index).append('circle')
      .attr('cx', (d, i) => xScale(i + (Math.random()*2)/40))
      .attr('cy', (d) => {
      
        return yScale(d.OPS)}) 
      .attr('r', 8)
      .style('fill', (d) => {
        if (index === 0) {
          return 'blue'
        } else if (index === 1) {
          console.log(d)
          return 'red'
        } else {
          return 'yellow'
        }
      })

    svg.selectAll('.d3BubbleG' + index)
      .data(data)
      .enter()
      .append('g')
      .classed('d3BubbleG' + index, true) 

    d3.selectAll('.d3BubbleG' + index).append('rect')
      .attr('x', (d, i) => xScale(i + (Math.random()*2)/40))
      .attr('y', (d) => {
        
        return yScale(d.OBP)}) 
      .attr('height', 10)
      .attr('width', 10)
      .style('fill', (d) => {
        if (index === 0) {
          return 'blue'
        } else if (index === 1) {
          return 'red'
        } else {
          return 'yellow'
        }
      })

      svg.selectAll('.d3BubbleG' + index)
      .data(data)
      .enter()
      .append('g')
      .classed('d3BubbleG' + index, true) 

    d3.selectAll('.d3BubbleG' + index).append('circle')
      .attr('cx', (d, i) => xScale(i + (Math.random()*2)/40))
      .attr('cy', (d) => {
        
        return yScale(d.SLG)}) 
      .attr('r', 8)
      .style('stroke', (d) => {
        if (index === 0) {
          return 'blue'
        } else if (index === 1) {
          return 'red'
        } else {
          return 'yellow'
        }
      })
      .style('fill', 'transparent')

  
    


  }



  function renderChart(data) {
    d3.select('svg').selectAll('*').remove()

    var min = d3.min(data.map((d) => {
      return d3.min(d.map((e) => {
        return d3.min([e.OBP, e.SLG, e.OPS])
      }))
    }))

    var max = d3.max(data.map((d) => {
      return d3.max(d.map((e) => {
        return d3.max([e.OBP, e.SLG, e.OPS])
      }))
    }))


    var xScale = d3.scaleLinear()
      .domain([0, d3.max(data.map((d) => d.length))])
      .range([padding, width - padding])

    var yScale = d3.scaleLinear()
      .domain([min, max])
      .range([height - padding, padding])


    data.forEach((d, index) => renderData(d, index, xScale, yScale))
  }

  renderChart(data)








  </script>
</body>
</html>
